<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìƒí’ˆ ë“±ë¡ ê´€ë¦¬ì</title>

  <!-- Netlify Identity -->
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>

  <style>
    :root{
      --bg:#0b1220; --card:#141b2d; --text:#e6ecff; --muted:#9fb0d1;
      --accent:#49a5ff; --accent-pressed:#3186d7; --border:#243150;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:linear-gradient(180deg,var(--bg),#0f162b 55%, #0b1220);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Helvetica, Arial;
      color:var(--text); display:flex; align-items:center; justify-content:center; padding:24px;
    }
    .wrap{width:100%; max-width:720px}
    .card{background:var(--card); border:1px solid var(--border); border-radius:20px; padding:32px;
          box-shadow:0 10px 40px rgba(0,0,0,.35)}
    h1{margin:0 0 10px; font-size:26px}
    p.lead{margin:0 0 24px; color:var(--muted)}
    .actions{display:flex; gap:12px; flex-wrap:wrap}
    .btn{appearance:none; border:1px solid transparent; border-radius:12px; padding:12px 18px;
         font-weight:600; cursor:pointer; transition:.15s transform,.15s background-color,.15s border-color}
    .btn:hover{transform:translateY(-1px)} .btn:active{transform:translateY(0)}
    .btn-primary{background:var(--accent); color:#081120}
    .btn-primary:active{background:var(--accent-pressed)}
    .btn-ghost{background:transparent; color:var(--text); border-color:var(--border)}
    .meta{margin-top:18px; font-size:13px; color:var(--muted)}
    [data-netlify-identity-button],[data-netlify-identity-menu]{display:none!important}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>ìƒí’ˆ ë“±ë¡ ê´€ë¦¬ì</h1>
      <p class="lead">GitHub ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ë©´ CMSì—ì„œ ìƒí’ˆì„ ë“±ë¡Â·ìˆ˜ì •í•  ìˆ˜ ìˆì–´ìš”.</p>

      <div class="actions">
        <button id="btn-login" class="btn btn-primary">GitHubìœ¼ë¡œ ë¡œê·¸ì¸</button>
        <button id="btn-dashboard" class="btn btn-ghost" style="display:none;">ê´€ë¦¬ì ì—´ê¸°</button>
        <button id="btn-logout" class="btn btn-ghost" style="display:none;">ë¡œê·¸ì•„ì›ƒ</button>
      </div>

      <p class="meta" id="meta-state">ìƒíƒœ: ì´ˆê¸°í™” ì¤‘â€¦</p>

      <!-- ìˆ¨ê¹€: ê¸°ë³¸ ìœ„ì ¯ -->
      <div data-netlify-identity-button></div>
      <div data-netlify-identity-menu></div>
    </div>
  </div>

  <!-- Netlify CMS -->
  <script src="https://unpkg.com/netlify-cms-app@latest/dist/netlify-cms.js"></script>

<script>
  const $ = s => document.querySelector(s);
  const setState = s => $('#meta-state').textContent = `ìƒíƒœ: ${s}`;

  const API_URL = 'https://eastpage.netlify.app/.netlify/identity';

  if (window.netlifyIdentity) {
    window.netlifyIdentity.init({ APIUrl: API_URL });

    window.netlifyIdentity.on('init', (user) => {
      setState(user ? (user.email || 'ë¡œê·¸ì¸ë¨') : 'ë¡œê·¸ì•„ì›ƒë¨');
      $('#btn-login').style.display   = user ? 'none' : 'inline-flex';
      $('#btn-dashboard').style.display = user ? 'inline-flex' : 'none';
      $('#btn-logout').style.display = user ? 'inline-flex' : 'none';
    });

    window.netlifyIdentity.on('login', (user) => {
      setState(user.email || 'ë¡œê·¸ì¸ë¨');
      location.replace('/admin/');
    });

    window.netlifyIdentity.on('logout', () => {
      setState('ë¡œê·¸ì•„ì›ƒë¨');
      location.replace('/admin/');
    });
  } else {
    setState('Identity ìœ„ì ¯ ë¡œë“œ ì‹¤íŒ¨');
  }

  // ğŸ‘‡ GitHub ë¡œê·¸ì¸ ê°•ì œ ì‹¤í–‰
  $('#btn-login').addEventListener('click', () => {
    if (window.netlifyIdentity) {
      window.netlifyIdentity.open('login'); 
      // ê¸°ë³¸ ìœ„ì ¯ì´ ì•„ë‹ˆë¼ GitHub provider ë°”ë¡œ í˜¸ì¶œ
      window.netlifyIdentity.authenticate({ provider: "github" });
    }
  });

  $('#btn-dashboard').addEventListener('click', () => location.href = '/admin/');
  $('#btn-logout').addEventListener('click', () => window.netlifyIdentity && window.netlifyIdentity.logout());
</script>
</body>
</html>
